(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5025:function(e,t,o){Promise.resolve().then(o.bind(o,6117))},6117:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return a}});var n=o(7437),l=o(2265);function a(){let[e,t]=(0,l.useState)(null),[o,a]=(0,l.useState)(""),[r,s]=(0,l.useState)(!1),c=async t=>{if(t.preventDefault(),a(""),s(!0),!e){a("Please select a .docx file."),s(!1);return}let o=new FormData;o.append("docxFile",e);try{let e=await fetch("/api/process-doc",{method:"POST",body:o});if(e.ok){let t=await e.blob(),o=window.URL.createObjectURL(t),n=document.createElement("a");n.href=o,n.download="competition_results.csv",document.body.appendChild(n),n.click(),n.remove(),a("CSV generated and downloaded successfully!")}else{let t=await e.json();a("Error: ".concat(t.error||"Something went wrong"))}}catch(e){a("Error: ".concat(e.message||"Network error"))}finally{s(!1)}};return(0,n.jsxs)("div",{className:"min-h-screen bg-gray-100 flex flex-col items-center justify-center p-4",children:[(0,n.jsx)("h1",{className:"text-4xl font-bold text-gray-800 mb-8",children:"Ballroom Competition Results to CSV"}),(0,n.jsxs)("form",{onSubmit:c,className:"bg-white p-8 rounded-lg shadow-md w-full max-w-md",children:[(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{htmlFor:"docxFile",className:"block text-gray-700 text-sm font-bold mb-2",children:"Upload .docx File:"}),(0,n.jsx)("input",{type:"file",id:"docxFile",accept:".docx",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",onChange:e=>{e.target.files&&e.target.files[0]?t(e.target.files[0]):t(null)},required:!0})]}),(0,n.jsx)("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline ".concat(r?"opacity-50 cursor-not-allowed":""),disabled:r,children:r?"Processing...":"Generate CSV"})]}),o&&(0,n.jsx)("p",{className:"mt-4 text-center ".concat(o.startsWith("Error")?"text-red-500":"text-green-500"),children:o})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=5025)}),_N_E=e.O()}]);