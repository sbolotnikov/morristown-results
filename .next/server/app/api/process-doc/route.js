"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/process-doc/route";
exports.ids = ["app/api/process-doc/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fprocess-doc%2Froute&page=%2Fapi%2Fprocess-doc%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fprocess-doc%2Froute.ts&appDir=C%3A%5CUsers%5Csbolo%5CWebProjects%5Cmorristown-results%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Csbolo%5CWebProjects%5Cmorristown-results&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fprocess-doc%2Froute&page=%2Fapi%2Fprocess-doc%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fprocess-doc%2Froute.ts&appDir=C%3A%5CUsers%5Csbolo%5CWebProjects%5Cmorristown-results%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Csbolo%5CWebProjects%5Cmorristown-results&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_sbolo_WebProjects_morristown_results_src_app_api_process_doc_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/process-doc/route.ts */ \"(rsc)/./src/app/api/process-doc/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/process-doc/route\",\n        pathname: \"/api/process-doc\",\n        filename: \"route\",\n        bundlePath: \"app/api/process-doc/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\sbolo\\\\WebProjects\\\\morristown-results\\\\src\\\\app\\\\api\\\\process-doc\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_sbolo_WebProjects_morristown_results_src_app_api_process_doc_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/process-doc/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZwcm9jZXNzLWRvYyUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGcHJvY2Vzcy1kb2MlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZwcm9jZXNzLWRvYyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNzYm9sbyU1Q1dlYlByb2plY3RzJTVDbW9ycmlzdG93bi1yZXN1bHRzJTVDc3JjJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1DJTNBJTVDVXNlcnMlNUNzYm9sbyU1Q1dlYlByb2plY3RzJTVDbW9ycmlzdG93bi1yZXN1bHRzJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUN1QztBQUNwSDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL21vcnJpc3Rvd24tcmVzdWx0cy8/NGI0ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxVc2Vyc1xcXFxzYm9sb1xcXFxXZWJQcm9qZWN0c1xcXFxtb3JyaXN0b3duLXJlc3VsdHNcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxccHJvY2Vzcy1kb2NcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3Byb2Nlc3MtZG9jL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvcHJvY2Vzcy1kb2NcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3Byb2Nlc3MtZG9jL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcVXNlcnNcXFxcc2JvbG9cXFxcV2ViUHJvamVjdHNcXFxcbW9ycmlzdG93bi1yZXN1bHRzXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXHByb2Nlc3MtZG9jXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9wcm9jZXNzLWRvYy9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fprocess-doc%2Froute&page=%2Fapi%2Fprocess-doc%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fprocess-doc%2Froute.ts&appDir=C%3A%5CUsers%5Csbolo%5CWebProjects%5Cmorristown-results%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Csbolo%5CWebProjects%5Cmorristown-results&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/process-doc/route.ts":
/*!******************************************!*\
  !*** ./src/app/api/process-doc/route.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var pizzip__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pizzip */ \"(rsc)/./node_modules/pizzip/js/index.js\");\n/* harmony import */ var pizzip__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pizzip__WEBPACK_IMPORTED_MODULE_1__);\n\n\nconst runtime = \"nodejs\"; // Specify Node.js runtime\nasync function POST(req) {\n    console.log(\"API route /api/process-doc received a request.\");\n    try {\n        const formData = await req.formData();\n        const docxFile = formData.get(\"docxFile\");\n        if (!docxFile) {\n            console.error(\"No .docx file uploaded.\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"No .docx file uploaded\"\n            }, {\n                status: 400\n            });\n        }\n        console.log(\"Processing uploaded file:\", docxFile.name);\n        const arrayBuffer = await docxFile.arrayBuffer();\n        let text = \"\";\n        const processedData = [];\n        const processedDataAmateurCouples = [];\n        try {\n            const zip = new (pizzip__WEBPACK_IMPORTED_MODULE_1___default())(arrayBuffer);\n            // Extract text with preserved line breaks by parsing the document.xml directly\n            const docXml = zip.files[\"word/document.xml\"];\n            if (!docXml) {\n                throw new Error(\"Invalid DOCX file: missing document.xml\");\n            }\n            const xmlContent = docXml.asText();\n            // Parse paragraphs and preserve line breaks\n            const paragraphMatches = xmlContent.match(/<w:p[^>]*>(.*?)<\\/w:p>/g) || [];\n            let paragraphs = [];\n            for (const paragraphMatch of paragraphMatches){\n                const textMatches = paragraphMatch.match(/<w:t[^>]*>(.*?)<\\/w:t>/g) || [];\n                let paragraphText = \"\";\n                for (const textMatch of textMatches){\n                    const textContent = textMatch.replace(/<\\/?w:t[^>]*>/g, \"\");\n                    paragraphText += textContent;\n                }\n                if (paragraphText.trim()) {\n                    paragraphs.push(paragraphText.trim());\n                }\n            }\n            text = paragraphs.join(\"\\n\");\n        //console.log('Extracted text from docx with line breaks:', text); // Log the full extracted text for debugging\n        } catch (parsingError) {\n            console.error(\"Error during document parsing:\", parsingError);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: `Document parsing failed: ${parsingError.message || \"Unknown error\"}`\n            }, {\n                status: 500\n            });\n        }\n        console.log(\"Extracted text from docx with line breaks:\", text.split(\"\\n\").length);\n        if (!text || text.trim() === \"\") {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Could not extract text from the document. It might be empty or corrupted.\"\n            }, {\n                status: 400\n            });\n        }\n        // Split text into lines for easier processing\n        const lines = text.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.length > 0);\n        // console.log('Lines extracted:', lines);\n        let sumOfPoints = 0;\n        // Process lines to extract competition data\n        for(let i = 0; i < lines.length; i++){\n            const line = lines[i];\n            let currentstudent;\n            // Check if this line contains student/teacher info in format: \"Name/Name (#number) [Location]\" or \"Name (#number)/Name [Location]\"\n            const studentTeacherMatch = line.match(/^(.+?)\\/(.+?)\\s*\\(#\\d+\\)\\s*\\[.+?\\]$|^(.+?)\\s*\\(#\\d+\\)\\/(.+?)\\s*\\[.+?\\]$/);\n            if (studentTeacherMatch) {\n                // Handle both formats: Name/Name (#number) [Location] and Name (#number)/Name [Location]\n                let student, teacher;\n                if (studentTeacherMatch[1] && studentTeacherMatch[2]) {\n                    // Format: Name/Name (#number) [Location]\n                    student = studentTeacherMatch[1].trim();\n                    teacher = studentTeacherMatch[2].trim();\n                } else if (studentTeacherMatch[3] && studentTeacherMatch[4]) {\n                    // Format: Name (#number)/Name [Location]\n                    student = studentTeacherMatch[3].trim();\n                    teacher = studentTeacherMatch[4].trim();\n                }\n                // Look ahead for all place/proficiency and heat/event information for this student/teacher pair\n                let j = i + 1;\n                // Continue processing entries until we hit another student/teacher line or end of file\n                while(j < lines.length){\n                    // Check if we've hit another student/teacher line\n                    const nextStudentTeacherMatch = lines[j].match(/^(.+?)\\/(.+?)\\s*\\(#\\d+\\)\\s*\\[.+?\\]$|^(.+?)\\s*\\(#\\d+\\)\\/(.+?)\\s*\\[.+?\\]$/);\n                    if (nextStudentTeacherMatch) {\n                        break;\n                    }\n                    let place = \"\";\n                    let proficiency = \"\";\n                    let heatNumber = \"\";\n                    let eventDescription = \"\";\n                    // Find place/proficiency line (format: \"1 [93.0]\" or just \"1\")\n                    const placeLine = lines[j];\n                    const placeMatch = placeLine.match(/^(\\d+)(?:\\s*\\[(\\d+\\.?\\d*)\\])?$/);\n                    if (placeMatch) {\n                        place = placeMatch[1];\n                        proficiency = placeMatch[2] || \"\";\n                        j++;\n                        // Find heat line (format: \"Heat 612\")\n                        while(j < lines.length){\n                            const heatLine = lines[j];\n                            const heatMatch = heatLine.match(/^(Heat|Solo)\\s+(\\d+)$/);\n                            if (heatMatch) {\n                                heatNumber = heatMatch[1] + \" \" + heatMatch[2];\n                                j++;\n                                break;\n                            }\n                            j++;\n                        }\n                        // Find event description line (next line after heat)\n                        if (j < lines.length) {\n                            // Check if this is another student/teacher line\n                            const checkStudentTeacher = lines[j].match(/^(.+?)\\/(.+?)\\s*\\(#\\d+\\)\\s*\\[.+?\\]$|^(.+?)\\s*\\(#\\d+\\)\\/(.+?)\\s*\\[.+?\\]$/);\n                            if (!checkStudentTeacher) {\n                                eventDescription = lines[j];\n                                j++;\n                            }\n                        }\n                        // Process this entry if we have all required information\n                        if (student && teacher && place && heatNumber && eventDescription) {\n                            // Check for \"AC-\" or \"Pro heat\" indicators\n                            if (eventDescription.includes(\"AC-\")) {\n                                // Process AC- entries separately\n                                const fullEvent = ` ${heatNumber} ${eventDescription.trim()}`;\n                                let points = 0;\n                                // Base Points for Event Types\n                                if (fullEvent.includes(\"Schol\") || fullEvent.includes(\"Champ\")) {\n                                    // For Scholarship or Championship events, count slashes between parentheses\n                                    const parenthesesMatch = fullEvent.match(/\\(([^)]+)\\)/);\n                                    if (parenthesesMatch) {\n                                        const contentInParentheses = parenthesesMatch[1];\n                                        const slashCount = (contentInParentheses.match(/\\//g) || []).length;\n                                        points = slashCount + 2;\n                                    } else {\n                                        points = 2;\n                                    }\n                                } else {\n                                    points = 11;\n                                }\n                                // Additional Points for Placement or Proficiency\n                                if (proficiency) {\n                                    const profScore = parseFloat(proficiency);\n                                    if (profScore >= 96.5) {\n                                        points += 3;\n                                    } else if (profScore >= 93.5) {\n                                        points += 2;\n                                    } else if (profScore >= 89.5) {\n                                        points += 1;\n                                    }\n                                } else {\n                                    const placeNum = parseInt(place);\n                                    if (placeNum === 1) {\n                                        points += 3;\n                                    } else if (placeNum === 2) {\n                                        points += 2;\n                                    } else if (placeNum === 3) {\n                                        points += 1;\n                                    } else if (isNaN(placeNum)) {\n                                        points -= 1;\n                                    }\n                                }\n                                processedDataAmateurCouples.push({\n                                    Student: student.trim(),\n                                    Teacher: teacher.trim(),\n                                    Event: fullEvent.trim(),\n                                    Place: place.trim(),\n                                    Proficiency: proficiency ? proficiency.trim() : \"\",\n                                    Points: points\n                                });\n                                continue;\n                            } else if (eventDescription.toLowerCase().includes(\"pro heat\")) {\n                                continue;\n                            }\n                            const fullEvent = ` ${heatNumber} ${eventDescription.trim()}`;\n                            let points = 0;\n                            // Base Points for Event Types\n                            if (fullEvent.includes(\"Schol\") || fullEvent.includes(\"Champ\")) {\n                                // For Scholarship or Championship events, count slashes between parentheses\n                                const parenthesesMatch = fullEvent.match(/\\(([^)]+)\\)/);\n                                if (parenthesesMatch) {\n                                    const contentInParentheses = parenthesesMatch[1];\n                                    const slashCount = (contentInParentheses.match(/\\//g) || []).length;\n                                    points = slashCount + 2; //because of substruction -1 in the end+1 and +1 because of slashes less then dances\n                                } else {\n                                    // Default if no parentheses found\n                                    points = 2;\n                                }\n                            } else {\n                                // All individual entries, Solo, Novelty, Showcase\n                                points = 11;\n                            }\n                            // Additional Points for Placement or Proficiency\n                            if (proficiency) {\n                                const profScore = parseFloat(proficiency);\n                                if (profScore >= 96.5) {\n                                    points += 3;\n                                } else if (profScore >= 93.5) {\n                                    points += 2;\n                                } else if (profScore >= 89.5) {\n                                    points += 1;\n                                }\n                            } else {\n                                const placeNum = parseInt(place);\n                                if (placeNum === 1) {\n                                    points += 3;\n                                } else if (placeNum === 2) {\n                                    points += 2;\n                                } else if (placeNum === 3) {\n                                    points += 1;\n                                } else if (isNaN(placeNum)) {\n                                    // If no numerical place\n                                    points -= 1;\n                                }\n                            }\n                            if (currentstudent !== student.trim()) {\n                                currentstudent = student.trim();\n                                if (processedData.length > 1) processedData.push({\n                                    Student: \"Total :\",\n                                    Teacher: \"\",\n                                    Event: \"\",\n                                    Place: \"\",\n                                    Proficiency: \"\",\n                                    Points: sumOfPoints\n                                });\n                                sumOfPoints = points;\n                            } else {\n                                sumOfPoints += points;\n                            }\n                            processedData.push({\n                                Student: student.trim(),\n                                Teacher: teacher.trim(),\n                                Event: fullEvent.trim(),\n                                Place: place.trim(),\n                                Proficiency: proficiency ? proficiency.trim() : \"\",\n                                Points: points\n                            });\n                        } else {\n                            console.log(\"Skipping incomplete entry:\", {\n                                student,\n                                teacher,\n                                place,\n                                heatNumber,\n                                eventDescription\n                            });\n                        }\n                    } else {\n                        // If this line doesn't match a place pattern, move to next line\n                        j++;\n                    }\n                }\n                // Update i to j-1 so the main loop continues from where we left off\n                i = j - 1;\n            }\n        }\n        if (processedData.length === 0) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"No valid entries found in the document after processing.\"\n            }, {\n                status: 400\n            });\n        }\n        // Calculate totals for each unique student and teacher\n        const studentTotals = new Map();\n        const teacherTotals = new Map();\n        // Calculate totals from processed data (excluding any existing \"Total :\" entries)\n        processedData.forEach((entry)=>{\n            if (entry.Student !== \"Total :\") {\n                const student = entry.Student;\n                const teacher = entry.Teacher;\n                const points = entry.Points;\n                // Add to student totals\n                studentTotals.set(student, (studentTotals.get(student) || 0) + points);\n                // Add to teacher totals\n                teacherTotals.set(teacher, (teacherTotals.get(teacher) || 0) + points);\n            }\n        });\n        // Create final data array with proper order\n        const finalProcessedData = [];\n        // 1. Add student totals first\n        finalProcessedData.push({\n            Student: \"STUDENT TOTALS:\",\n            Teacher: \"\",\n            Event: \"\",\n            Place: \"\",\n            Proficiency: \"\",\n            Points: \"\"\n        });\n        studentTotals.forEach((total, student)=>{\n            finalProcessedData.push({\n                Student: student,\n                Teacher: \"\",\n                Event: \"\",\n                Place: \"\",\n                Proficiency: \"\",\n                Points: total\n            });\n        });\n        // 2. Add teacher totals\n        finalProcessedData.push({\n            Student: \"\",\n            Teacher: \"\",\n            Event: \"\",\n            Place: \"\",\n            Proficiency: \"\",\n            Points: \"\"\n        });\n        finalProcessedData.push({\n            Student: \"TEACHER TOTALS:\",\n            Teacher: \"\",\n            Event: \"\",\n            Place: \"\",\n            Proficiency: \"\",\n            Points: \"\"\n        });\n        teacherTotals.forEach((total, teacher)=>{\n            finalProcessedData.push({\n                Student: \"\",\n                Teacher: teacher,\n                Event: \"\",\n                Place: \"\",\n                Proficiency: \"\",\n                Points: total\n            });\n        });\n        // 3. Add Amateur Couples totals (if any)\n        if (processedDataAmateurCouples.length > 0) {\n            const amateurCoupleTotals = new Map();\n            processedDataAmateurCouples.forEach((entry)=>{\n                const coupleKey = `${entry.Student}/${entry.Teacher}`;\n                amateurCoupleTotals.set(coupleKey, (amateurCoupleTotals.get(coupleKey) || 0) + entry.Points);\n            });\n            finalProcessedData.push({\n                Student: \"\",\n                Teacher: \"\",\n                Event: \"\",\n                Place: \"\",\n                Proficiency: \"\",\n                Points: \"\"\n            });\n            finalProcessedData.push({\n                Student: \"AMATEUR COUPLES TOTALS:\",\n                Teacher: \"\",\n                Event: \"\",\n                Place: \"\",\n                Proficiency: \"\",\n                Points: \"\"\n            });\n            amateurCoupleTotals.forEach((total, couple)=>{\n                const [student, teacher] = couple.split(\"/\");\n                finalProcessedData.push({\n                    Student: student,\n                    Teacher: teacher,\n                    Event: \"\",\n                    Place: \"\",\n                    Proficiency: \"\",\n                    Points: total\n                });\n            });\n            // 4. Add Amateur Couples entries\n            finalProcessedData.push({\n                Student: \"\",\n                Teacher: \"\",\n                Event: \"\",\n                Place: \"\",\n                Proficiency: \"\",\n                Points: \"\"\n            });\n            finalProcessedData.push({\n                Student: \"AMATEUR COUPLES ENTRIES:\",\n                Teacher: \"\",\n                Event: \"\",\n                Place: \"\",\n                Proficiency: \"\",\n                Points: \"\"\n            });\n            processedDataAmateurCouples.forEach((entry)=>{\n                finalProcessedData.push(entry);\n            });\n        }\n        // 5. Add other entries (main competition entries)\n        finalProcessedData.push({\n            Student: \"\",\n            Teacher: \"\",\n            Event: \"\",\n            Place: \"\",\n            Proficiency: \"\",\n            Points: \"\"\n        });\n        finalProcessedData.push({\n            Student: \"MAIN COMPETITION ENTRIES:\",\n            Teacher: \"\",\n            Event: \"\",\n            Place: \"\",\n            Proficiency: \"\",\n            Points: \"\"\n        });\n        // Add all main entries (excluding \"Total :\" entries)\n        processedData.forEach((entry)=>{\n            if (entry.Student !== \"Total :\") {\n                finalProcessedData.push(entry);\n            }\n        });\n        // Generate CSV\n        const csvHeader = \"Student,Teacher,Event,Place,Proficiency,Points\\n\";\n        const csvRows = finalProcessedData.map((row)=>`\"${row.Student}\",\"${row.Teacher}\",\"${row.Event}\",\"${row.Place}\",\"${row.Proficiency}\",${row.Points}`).join(\"\\n\");\n        const csv = csvHeader + csvRows;\n        return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(csv, {\n            headers: {\n                \"Content-Type\": \"text/csv\",\n                \"Content-Disposition\": 'attachment; filename=\"competition_results.csv\"'\n            }\n        });\n    } catch (error) {\n        console.error(\"Unhandled error in API route:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message || \"Internal Server Error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9wcm9jZXNzLWRvYy9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUF3RDtBQUU1QjtBQUVyQixNQUFNRSxVQUFVLFNBQVMsQ0FBQywwQkFBMEI7QUFFcEQsZUFBZUMsS0FBS0MsR0FBZ0I7SUFDekNDLFFBQVFDLEdBQUcsQ0FBQztJQUNaLElBQUk7UUFDRixNQUFNQyxXQUFXLE1BQU1ILElBQUlHLFFBQVE7UUFDbkMsTUFBTUMsV0FBV0QsU0FBU0UsR0FBRyxDQUFDO1FBRTlCLElBQUksQ0FBQ0QsVUFBVTtZQUNiSCxRQUFRSyxLQUFLLENBQUM7WUFDZCxPQUFPVixxREFBWUEsQ0FBQ1csSUFBSSxDQUN0QjtnQkFBRUQsT0FBTztZQUF5QixHQUNsQztnQkFBRUUsUUFBUTtZQUFJO1FBRWxCO1FBRUFQLFFBQVFDLEdBQUcsQ0FBQyw2QkFBNkJFLFNBQVNLLElBQUk7UUFFdEQsTUFBTUMsY0FBYyxNQUFNTixTQUFTTSxXQUFXO1FBRTlDLElBQUlDLE9BQU87UUFDWCxNQUFNQyxnQkFBdUIsRUFBRTtRQUMvQixNQUFNQyw4QkFBcUMsRUFBRTtRQUM3QyxJQUFJO1lBQ0YsTUFBTUMsTUFBTSxJQUFJakIsK0NBQU1BLENBQUNhO1lBRXZCLCtFQUErRTtZQUMvRSxNQUFNSyxTQUFTRCxJQUFJRSxLQUFLLENBQUMsb0JBQW9CO1lBQzdDLElBQUksQ0FBQ0QsUUFBUTtnQkFDWCxNQUFNLElBQUlFLE1BQU07WUFDbEI7WUFFQSxNQUFNQyxhQUFhSCxPQUFPSSxNQUFNO1lBRWhDLDRDQUE0QztZQUM1QyxNQUFNQyxtQkFDSkYsV0FBV0csS0FBSyxDQUFDLDhCQUE4QixFQUFFO1lBQ25ELElBQUlDLGFBQWEsRUFBRTtZQUVuQixLQUFLLE1BQU1DLGtCQUFrQkgsaUJBQWtCO2dCQUM3QyxNQUFNSSxjQUNKRCxlQUFlRixLQUFLLENBQUMsOEJBQThCLEVBQUU7Z0JBQ3ZELElBQUlJLGdCQUFnQjtnQkFFcEIsS0FBSyxNQUFNQyxhQUFhRixZQUFhO29CQUNuQyxNQUFNRyxjQUFjRCxVQUFVRSxPQUFPLENBQUMsa0JBQWtCO29CQUN4REgsaUJBQWlCRTtnQkFDbkI7Z0JBRUEsSUFBSUYsY0FBY0ksSUFBSSxJQUFJO29CQUN4QlAsV0FBV1EsSUFBSSxDQUFDTCxjQUFjSSxJQUFJO2dCQUNwQztZQUNGO1lBRUFsQixPQUFPVyxXQUFXUyxJQUFJLENBQUM7UUFDdkIsK0dBQStHO1FBQ2pILEVBQUUsT0FBT0MsY0FBbUI7WUFDMUIvQixRQUFRSyxLQUFLLENBQUMsa0NBQWtDMEI7WUFDaEQsT0FBT3BDLHFEQUFZQSxDQUFDVyxJQUFJLENBQ3RCO2dCQUNFRCxPQUFPLENBQUMseUJBQXlCLEVBQy9CMEIsYUFBYUMsT0FBTyxJQUFJLGdCQUN6QixDQUFDO1lBQ0osR0FDQTtnQkFBRXpCLFFBQVE7WUFBSTtRQUVsQjtRQUNBUCxRQUFRQyxHQUFHLENBQ1QsOENBQ0FTLEtBQUt1QixLQUFLLENBQUMsTUFBTUMsTUFBTTtRQUV6QixJQUFJLENBQUN4QixRQUFRQSxLQUFLa0IsSUFBSSxPQUFPLElBQUk7WUFDL0IsT0FBT2pDLHFEQUFZQSxDQUFDVyxJQUFJLENBQ3RCO2dCQUNFRCxPQUNFO1lBQ0osR0FDQTtnQkFBRUUsUUFBUTtZQUFJO1FBRWxCO1FBRUEsOENBQThDO1FBQzlDLE1BQU00QixRQUFRekIsS0FDWHVCLEtBQUssQ0FBQyxNQUNORyxHQUFHLENBQUMsQ0FBQ0MsT0FBU0EsS0FBS1QsSUFBSSxJQUN2QlUsTUFBTSxDQUFDLENBQUNELE9BQVNBLEtBQUtILE1BQU0sR0FBRztRQUVsQywwQ0FBMEM7UUFDMUMsSUFBSUssY0FBYztRQUNsQiw0Q0FBNEM7UUFDNUMsSUFBSyxJQUFJQyxJQUFJLEdBQUdBLElBQUlMLE1BQU1ELE1BQU0sRUFBRU0sSUFBSztZQUNyQyxNQUFNSCxPQUFPRixLQUFLLENBQUNLLEVBQUU7WUFDckIsSUFBSUM7WUFFSixtSUFBbUk7WUFDbkksTUFBTUMsc0JBQXNCTCxLQUFLakIsS0FBSyxDQUNwQztZQUdGLElBQUlzQixxQkFBcUI7Z0JBQ3ZCLHlGQUF5RjtnQkFDekYsSUFBSUMsU0FBU0M7Z0JBRWIsSUFBSUYsbUJBQW1CLENBQUMsRUFBRSxJQUFJQSxtQkFBbUIsQ0FBQyxFQUFFLEVBQUU7b0JBQ3BELHlDQUF5QztvQkFDekNDLFVBQVVELG1CQUFtQixDQUFDLEVBQUUsQ0FBQ2QsSUFBSTtvQkFDckNnQixVQUFVRixtQkFBbUIsQ0FBQyxFQUFFLENBQUNkLElBQUk7Z0JBQ3ZDLE9BQU8sSUFBSWMsbUJBQW1CLENBQUMsRUFBRSxJQUFJQSxtQkFBbUIsQ0FBQyxFQUFFLEVBQUU7b0JBQzNELHlDQUF5QztvQkFDekNDLFVBQVVELG1CQUFtQixDQUFDLEVBQUUsQ0FBQ2QsSUFBSTtvQkFDckNnQixVQUFVRixtQkFBbUIsQ0FBQyxFQUFFLENBQUNkLElBQUk7Z0JBQ3ZDO2dCQUVBLGdHQUFnRztnQkFDaEcsSUFBSWlCLElBQUlMLElBQUk7Z0JBRVosdUZBQXVGO2dCQUN2RixNQUFPSyxJQUFJVixNQUFNRCxNQUFNLENBQUU7b0JBQ3ZCLGtEQUFrRDtvQkFDbEQsTUFBTVksMEJBQTBCWCxLQUFLLENBQUNVLEVBQUUsQ0FBQ3pCLEtBQUssQ0FDNUM7b0JBRUYsSUFBSTBCLHlCQUF5Qjt3QkFFM0I7b0JBQ0Y7b0JBRUEsSUFBSUMsUUFBUTtvQkFDWixJQUFJQyxjQUFjO29CQUNsQixJQUFJQyxhQUFhO29CQUNqQixJQUFJQyxtQkFBbUI7b0JBRXZCLCtEQUErRDtvQkFDL0QsTUFBTUMsWUFBWWhCLEtBQUssQ0FBQ1UsRUFBRTtvQkFDMUIsTUFBTU8sYUFBYUQsVUFBVS9CLEtBQUssQ0FBQztvQkFFbkMsSUFBSWdDLFlBQVk7d0JBQ2RMLFFBQVFLLFVBQVUsQ0FBQyxFQUFFO3dCQUNyQkosY0FBY0ksVUFBVSxDQUFDLEVBQUUsSUFBSTt3QkFDL0JQO3dCQUVBLHNDQUFzQzt3QkFDdEMsTUFBT0EsSUFBSVYsTUFBTUQsTUFBTSxDQUFFOzRCQUN2QixNQUFNbUIsV0FBV2xCLEtBQUssQ0FBQ1UsRUFBRTs0QkFDekIsTUFBTVMsWUFBWUQsU0FBU2pDLEtBQUssQ0FBQzs0QkFFakMsSUFBSWtDLFdBQVc7Z0NBQ2JMLGFBQWFLLFNBQVMsQ0FBQyxFQUFFLEdBQUcsTUFBTUEsU0FBUyxDQUFDLEVBQUU7Z0NBQzlDVDtnQ0FDQTs0QkFDRjs0QkFDQUE7d0JBQ0Y7d0JBRUEscURBQXFEO3dCQUNyRCxJQUFJQSxJQUFJVixNQUFNRCxNQUFNLEVBQUU7NEJBQ3BCLGdEQUFnRDs0QkFDaEQsTUFBTXFCLHNCQUFzQnBCLEtBQUssQ0FBQ1UsRUFBRSxDQUFDekIsS0FBSyxDQUN4Qzs0QkFFRixJQUFJLENBQUNtQyxxQkFBcUI7Z0NBQ3hCTCxtQkFBbUJmLEtBQUssQ0FBQ1UsRUFBRTtnQ0FDM0JBOzRCQUNGO3dCQUNGO3dCQUVBLHlEQUF5RDt3QkFDekQsSUFBSUYsV0FBV0MsV0FBV0csU0FBU0UsY0FBY0Msa0JBQWtCOzRCQUNqRSwyQ0FBMkM7NEJBQzNDLElBQUlBLGlCQUFpQk0sUUFBUSxDQUFDLFFBQVE7Z0NBQ3BDLGlDQUFpQztnQ0FDakMsTUFBTUMsWUFBWSxDQUFDLENBQUMsRUFBRVIsV0FBVyxDQUFDLEVBQUVDLGlCQUFpQnRCLElBQUksR0FBRyxDQUFDO2dDQUM3RCxJQUFJOEIsU0FBUztnQ0FFYiw4QkFBOEI7Z0NBQzlCLElBQ0VELFVBQVVELFFBQVEsQ0FBQyxZQUNuQkMsVUFBVUQsUUFBUSxDQUFDLFVBQ25CO29DQUNBLDRFQUE0RTtvQ0FDNUUsTUFBTUcsbUJBQW1CRixVQUFVckMsS0FBSyxDQUFDO29DQUN6QyxJQUFJdUMsa0JBQWtCO3dDQUNwQixNQUFNQyx1QkFBdUJELGdCQUFnQixDQUFDLEVBQUU7d0NBQ2hELE1BQU1FLGFBQWEsQ0FBQ0QscUJBQXFCeEMsS0FBSyxDQUFDLFVBQVUsRUFBRSxFQUN4RGMsTUFBTTt3Q0FDVHdCLFNBQVNHLGFBQWE7b0NBQ3hCLE9BQU87d0NBQ0xILFNBQVM7b0NBQ1g7Z0NBQ0YsT0FBTztvQ0FDTEEsU0FBUztnQ0FDWDtnQ0FFQSxpREFBaUQ7Z0NBQ2pELElBQUlWLGFBQWE7b0NBQ2YsTUFBTWMsWUFBWUMsV0FBV2Y7b0NBQzdCLElBQUljLGFBQWEsTUFBTTt3Q0FDckJKLFVBQVU7b0NBQ1osT0FBTyxJQUFJSSxhQUFhLE1BQU07d0NBQzVCSixVQUFVO29DQUNaLE9BQU8sSUFBSUksYUFBYSxNQUFNO3dDQUM1QkosVUFBVTtvQ0FDWjtnQ0FDRixPQUFPO29DQUNMLE1BQU1NLFdBQVdDLFNBQVNsQjtvQ0FDMUIsSUFBSWlCLGFBQWEsR0FBRzt3Q0FDbEJOLFVBQVU7b0NBQ1osT0FBTyxJQUFJTSxhQUFhLEdBQUc7d0NBQ3pCTixVQUFVO29DQUNaLE9BQU8sSUFBSU0sYUFBYSxHQUFHO3dDQUN6Qk4sVUFBVTtvQ0FDWixPQUFPLElBQUlRLE1BQU1GLFdBQVc7d0NBQzFCTixVQUFVO29DQUNaO2dDQUNGO2dDQUVBOUMsNEJBQTRCaUIsSUFBSSxDQUFDO29DQUMvQnNDLFNBQVN4QixRQUFRZixJQUFJO29DQUNyQndDLFNBQVN4QixRQUFRaEIsSUFBSTtvQ0FDckJ5QyxPQUFPWixVQUFVN0IsSUFBSTtvQ0FDckIwQyxPQUFPdkIsTUFBTW5CLElBQUk7b0NBQ2pCMkMsYUFBYXZCLGNBQWNBLFlBQVlwQixJQUFJLEtBQUs7b0NBQ2hENEMsUUFBUWQ7Z0NBQ1Y7Z0NBQ0E7NEJBQ0YsT0FBTyxJQUFJUixpQkFBaUJ1QixXQUFXLEdBQUdqQixRQUFRLENBQUMsYUFBYTtnQ0FFOUQ7NEJBQ0Y7NEJBRUEsTUFBTUMsWUFBWSxDQUFDLENBQUMsRUFBRVIsV0FBVyxDQUFDLEVBQUVDLGlCQUFpQnRCLElBQUksR0FBRyxDQUFDOzRCQUM3RCxJQUFJOEIsU0FBUzs0QkFFYiw4QkFBOEI7NEJBQzlCLElBQUlELFVBQVVELFFBQVEsQ0FBQyxZQUFZQyxVQUFVRCxRQUFRLENBQUMsVUFBVTtnQ0FDOUQsNEVBQTRFO2dDQUM1RSxNQUFNRyxtQkFBbUJGLFVBQVVyQyxLQUFLLENBQUM7Z0NBQ3pDLElBQUl1QyxrQkFBa0I7b0NBQ3BCLE1BQU1DLHVCQUF1QkQsZ0JBQWdCLENBQUMsRUFBRTtvQ0FFaEQsTUFBTUUsYUFBYSxDQUFDRCxxQkFBcUJ4QyxLQUFLLENBQUMsVUFBVSxFQUFFLEVBQ3hEYyxNQUFNO29DQUNUd0IsU0FBU0csYUFBYSxHQUFHLG9GQUFvRjtnQ0FDL0csT0FBTztvQ0FDTCxrQ0FBa0M7b0NBQ2xDSCxTQUFTO2dDQUNYOzRCQUNGLE9BQU87Z0NBQ0wsa0RBQWtEO2dDQUNsREEsU0FBUzs0QkFDWDs0QkFFQSxpREFBaUQ7NEJBQ2pELElBQUlWLGFBQWE7Z0NBQ2YsTUFBTWMsWUFBWUMsV0FBV2Y7Z0NBQzdCLElBQUljLGFBQWEsTUFBTTtvQ0FDckJKLFVBQVU7Z0NBQ1osT0FBTyxJQUFJSSxhQUFhLE1BQU07b0NBQzVCSixVQUFVO2dDQUNaLE9BQU8sSUFBSUksYUFBYSxNQUFNO29DQUM1QkosVUFBVTtnQ0FDWjs0QkFDRixPQUFPO2dDQUNMLE1BQU1NLFdBQVdDLFNBQVNsQjtnQ0FDMUIsSUFBSWlCLGFBQWEsR0FBRztvQ0FDbEJOLFVBQVU7Z0NBQ1osT0FBTyxJQUFJTSxhQUFhLEdBQUc7b0NBQ3pCTixVQUFVO2dDQUNaLE9BQU8sSUFBSU0sYUFBYSxHQUFHO29DQUN6Qk4sVUFBVTtnQ0FDWixPQUFPLElBQUlRLE1BQU1GLFdBQVc7b0NBQzFCLHdCQUF3QjtvQ0FDeEJOLFVBQVU7Z0NBQ1o7NEJBQ0Y7NEJBQ0EsSUFBSWpCLG1CQUFtQkUsUUFBUWYsSUFBSSxJQUFJO2dDQUNyQ2EsaUJBQWlCRSxRQUFRZixJQUFJO2dDQUM3QixJQUFJakIsY0FBY3VCLE1BQU0sR0FBRyxHQUN6QnZCLGNBQWNrQixJQUFJLENBQUM7b0NBQ2pCc0MsU0FBUztvQ0FDVEMsU0FBUztvQ0FDVEMsT0FBTztvQ0FDUEMsT0FBTztvQ0FDUEMsYUFBYTtvQ0FDYkMsUUFBUWpDO2dDQUNWO2dDQUNGQSxjQUFjbUI7NEJBQ2hCLE9BQU87Z0NBQ0xuQixlQUFlbUI7NEJBQ2pCOzRCQUNBL0MsY0FBY2tCLElBQUksQ0FBQztnQ0FDakJzQyxTQUFTeEIsUUFBUWYsSUFBSTtnQ0FDckJ3QyxTQUFTeEIsUUFBUWhCLElBQUk7Z0NBQ3JCeUMsT0FBT1osVUFBVTdCLElBQUk7Z0NBQ3JCMEMsT0FBT3ZCLE1BQU1uQixJQUFJO2dDQUNqQjJDLGFBQWF2QixjQUFjQSxZQUFZcEIsSUFBSSxLQUFLO2dDQUNoRDRDLFFBQVFkOzRCQUNWO3dCQUNGLE9BQU87NEJBQ0wxRCxRQUFRQyxHQUFHLENBQUMsOEJBQThCO2dDQUN4QzBDO2dDQUNBQztnQ0FDQUc7Z0NBQ0FFO2dDQUNBQzs0QkFDRjt3QkFDRjtvQkFDRixPQUFPO3dCQUNMLGdFQUFnRTt3QkFDaEVMO29CQUNGO2dCQUNGO2dCQUVBLG9FQUFvRTtnQkFDcEVMLElBQUlLLElBQUk7WUFDVjtRQUNGO1FBRUEsSUFBSWxDLGNBQWN1QixNQUFNLEtBQUssR0FBRztZQUM5QixPQUFPdkMscURBQVlBLENBQUNXLElBQUksQ0FDdEI7Z0JBQUVELE9BQU87WUFBMkQsR0FDcEU7Z0JBQUVFLFFBQVE7WUFBSTtRQUVsQjtRQUVBLHVEQUF1RDtRQUN2RCxNQUFNbUUsZ0JBQWdCLElBQUlDO1FBQzFCLE1BQU1DLGdCQUFnQixJQUFJRDtRQUUxQixrRkFBa0Y7UUFDbEZoRSxjQUFja0UsT0FBTyxDQUFDLENBQUNDO1lBQ3JCLElBQUlBLE1BQU1YLE9BQU8sS0FBSyxXQUFXO2dCQUMvQixNQUFNeEIsVUFBVW1DLE1BQU1YLE9BQU87Z0JBQzdCLE1BQU12QixVQUFVa0MsTUFBTVYsT0FBTztnQkFDN0IsTUFBTVYsU0FBU29CLE1BQU1OLE1BQU07Z0JBRTNCLHdCQUF3QjtnQkFDeEJFLGNBQWNLLEdBQUcsQ0FBQ3BDLFNBQVMsQ0FBQytCLGNBQWN0RSxHQUFHLENBQUN1QyxZQUFZLEtBQUtlO2dCQUUvRCx3QkFBd0I7Z0JBQ3hCa0IsY0FBY0csR0FBRyxDQUFDbkMsU0FBUyxDQUFDZ0MsY0FBY3hFLEdBQUcsQ0FBQ3dDLFlBQVksS0FBS2M7WUFDakU7UUFDRjtRQUVBLDRDQUE0QztRQUM1QyxNQUFNc0IscUJBQTRCLEVBQUU7UUFFcEMsOEJBQThCO1FBQzlCQSxtQkFBbUJuRCxJQUFJLENBQUM7WUFDdEJzQyxTQUFTO1lBQ1RDLFNBQVM7WUFDVEMsT0FBTztZQUNQQyxPQUFPO1lBQ1BDLGFBQWE7WUFDYkMsUUFBUTtRQUNWO1FBRUFFLGNBQWNHLE9BQU8sQ0FBQyxDQUFDSSxPQUFPdEM7WUFDNUJxQyxtQkFBbUJuRCxJQUFJLENBQUM7Z0JBQ3RCc0MsU0FBU3hCO2dCQUNUeUIsU0FBUztnQkFDVEMsT0FBTztnQkFDUEMsT0FBTztnQkFDUEMsYUFBYTtnQkFDYkMsUUFBUVM7WUFDVjtRQUNGO1FBRUEsd0JBQXdCO1FBQ3hCRCxtQkFBbUJuRCxJQUFJLENBQUM7WUFDdEJzQyxTQUFTO1lBQ1RDLFNBQVM7WUFDVEMsT0FBTztZQUNQQyxPQUFPO1lBQ1BDLGFBQWE7WUFDYkMsUUFBUTtRQUNWO1FBRUFRLG1CQUFtQm5ELElBQUksQ0FBQztZQUN0QnNDLFNBQVM7WUFDVEMsU0FBUztZQUNUQyxPQUFPO1lBQ1BDLE9BQU87WUFDUEMsYUFBYTtZQUNiQyxRQUFRO1FBQ1Y7UUFFQUksY0FBY0MsT0FBTyxDQUFDLENBQUNJLE9BQU9yQztZQUM1Qm9DLG1CQUFtQm5ELElBQUksQ0FBQztnQkFDdEJzQyxTQUFTO2dCQUNUQyxTQUFTeEI7Z0JBQ1R5QixPQUFPO2dCQUNQQyxPQUFPO2dCQUNQQyxhQUFhO2dCQUNiQyxRQUFRUztZQUNWO1FBQ0Y7UUFFQSx5Q0FBeUM7UUFDekMsSUFBSXJFLDRCQUE0QnNCLE1BQU0sR0FBRyxHQUFHO1lBQzFDLE1BQU1nRCxzQkFBc0IsSUFBSVA7WUFFaEMvRCw0QkFBNEJpRSxPQUFPLENBQUMsQ0FBQ0M7Z0JBQ25DLE1BQU1LLFlBQVksQ0FBQyxFQUFFTCxNQUFNWCxPQUFPLENBQUMsQ0FBQyxFQUFFVyxNQUFNVixPQUFPLENBQUMsQ0FBQztnQkFDckRjLG9CQUFvQkgsR0FBRyxDQUNyQkksV0FDQSxDQUFDRCxvQkFBb0I5RSxHQUFHLENBQUMrRSxjQUFjLEtBQUtMLE1BQU1OLE1BQU07WUFFNUQ7WUFFQVEsbUJBQW1CbkQsSUFBSSxDQUFDO2dCQUN0QnNDLFNBQVM7Z0JBQ1RDLFNBQVM7Z0JBQ1RDLE9BQU87Z0JBQ1BDLE9BQU87Z0JBQ1BDLGFBQWE7Z0JBQ2JDLFFBQVE7WUFDVjtZQUVBUSxtQkFBbUJuRCxJQUFJLENBQUM7Z0JBQ3RCc0MsU0FBUztnQkFDVEMsU0FBUztnQkFDVEMsT0FBTztnQkFDUEMsT0FBTztnQkFDUEMsYUFBYTtnQkFDYkMsUUFBUTtZQUNWO1lBRUFVLG9CQUFvQkwsT0FBTyxDQUFDLENBQUNJLE9BQU9HO2dCQUNsQyxNQUFNLENBQUN6QyxTQUFTQyxRQUFRLEdBQUd3QyxPQUFPbkQsS0FBSyxDQUFDO2dCQUN4QytDLG1CQUFtQm5ELElBQUksQ0FBQztvQkFDdEJzQyxTQUFTeEI7b0JBQ1R5QixTQUFTeEI7b0JBQ1R5QixPQUFPO29CQUNQQyxPQUFPO29CQUNQQyxhQUFhO29CQUNiQyxRQUFRUztnQkFDVjtZQUNGO1lBRUEsaUNBQWlDO1lBQ2pDRCxtQkFBbUJuRCxJQUFJLENBQUM7Z0JBQ3RCc0MsU0FBUztnQkFDVEMsU0FBUztnQkFDVEMsT0FBTztnQkFDUEMsT0FBTztnQkFDUEMsYUFBYTtnQkFDYkMsUUFBUTtZQUNWO1lBRUFRLG1CQUFtQm5ELElBQUksQ0FBQztnQkFDdEJzQyxTQUFTO2dCQUNUQyxTQUFTO2dCQUNUQyxPQUFPO2dCQUNQQyxPQUFPO2dCQUNQQyxhQUFhO2dCQUNiQyxRQUFRO1lBQ1Y7WUFFQTVELDRCQUE0QmlFLE9BQU8sQ0FBQyxDQUFDQztnQkFDbkNFLG1CQUFtQm5ELElBQUksQ0FBQ2lEO1lBQzFCO1FBQ0Y7UUFFQSxrREFBa0Q7UUFDbERFLG1CQUFtQm5ELElBQUksQ0FBQztZQUN0QnNDLFNBQVM7WUFDVEMsU0FBUztZQUNUQyxPQUFPO1lBQ1BDLE9BQU87WUFDUEMsYUFBYTtZQUNiQyxRQUFRO1FBQ1Y7UUFFQVEsbUJBQW1CbkQsSUFBSSxDQUFDO1lBQ3RCc0MsU0FBUztZQUNUQyxTQUFTO1lBQ1RDLE9BQU87WUFDUEMsT0FBTztZQUNQQyxhQUFhO1lBQ2JDLFFBQVE7UUFDVjtRQUVBLHFEQUFxRDtRQUNyRDdELGNBQWNrRSxPQUFPLENBQUMsQ0FBQ0M7WUFDckIsSUFBSUEsTUFBTVgsT0FBTyxLQUFLLFdBQVc7Z0JBQy9CYSxtQkFBbUJuRCxJQUFJLENBQUNpRDtZQUMxQjtRQUNGO1FBRUEsZUFBZTtRQUNmLE1BQU1PLFlBQVk7UUFDbEIsTUFBTUMsVUFBVU4sbUJBQ2I1QyxHQUFHLENBQ0YsQ0FBQ21ELE1BQ0MsQ0FBQyxDQUFDLEVBQUVBLElBQUlwQixPQUFPLENBQUMsR0FBRyxFQUFFb0IsSUFBSW5CLE9BQU8sQ0FBQyxHQUFHLEVBQUVtQixJQUFJbEIsS0FBSyxDQUFDLEdBQUcsRUFBRWtCLElBQUlqQixLQUFLLENBQUMsR0FBRyxFQUFFaUIsSUFBSWhCLFdBQVcsQ0FBQyxFQUFFLEVBQUVnQixJQUFJZixNQUFNLENBQUMsQ0FBQyxFQUV2RzFDLElBQUksQ0FBQztRQUVSLE1BQU0wRCxNQUFNSCxZQUFZQztRQUV4QixPQUFPLElBQUkzRixxREFBWUEsQ0FBQzZGLEtBQUs7WUFDM0JDLFNBQVM7Z0JBQ1AsZ0JBQWdCO2dCQUNoQix1QkFBdUI7WUFDekI7UUFDRjtJQUNGLEVBQUUsT0FBT3BGLE9BQVk7UUFDbkJMLFFBQVFLLEtBQUssQ0FBQyxpQ0FBaUNBO1FBQy9DLE9BQU9WLHFEQUFZQSxDQUFDVyxJQUFJLENBQ3RCO1lBQUVELE9BQU9BLE1BQU0yQixPQUFPLElBQUk7UUFBd0IsR0FDbEQ7WUFBRXpCLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbW9ycmlzdG93bi1yZXN1bHRzLy4vc3JjL2FwcC9hcGkvcHJvY2Vzcy1kb2Mvcm91dGUudHM/ZDVmNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IERvY3h0ZW1wbGF0ZXIgZnJvbSAnZG9jeHRlbXBsYXRlcic7XG5pbXBvcnQgUGl6WmlwIGZyb20gJ3BpenppcCc7XG5cbmV4cG9ydCBjb25zdCBydW50aW1lID0gJ25vZGVqcyc7IC8vIFNwZWNpZnkgTm9kZS5qcyBydW50aW1lXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcTogTmV4dFJlcXVlc3QpIHtcbiAgY29uc29sZS5sb2coJ0FQSSByb3V0ZSAvYXBpL3Byb2Nlc3MtZG9jIHJlY2VpdmVkIGEgcmVxdWVzdC4nKTtcbiAgdHJ5IHtcbiAgICBjb25zdCBmb3JtRGF0YSA9IGF3YWl0IHJlcS5mb3JtRGF0YSgpO1xuICAgIGNvbnN0IGRvY3hGaWxlID0gZm9ybURhdGEuZ2V0KCdkb2N4RmlsZScpIGFzIEZpbGUgfCBudWxsO1xuXG4gICAgaWYgKCFkb2N4RmlsZSkge1xuICAgICAgY29uc29sZS5lcnJvcignTm8gLmRvY3ggZmlsZSB1cGxvYWRlZC4nKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ05vIC5kb2N4IGZpbGUgdXBsb2FkZWQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygnUHJvY2Vzc2luZyB1cGxvYWRlZCBmaWxlOicsIGRvY3hGaWxlLm5hbWUpO1xuXG4gICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBkb2N4RmlsZS5hcnJheUJ1ZmZlcigpO1xuXG4gICAgbGV0IHRleHQgPSAnJztcbiAgICBjb25zdCBwcm9jZXNzZWREYXRhOiBhbnlbXSA9IFtdO1xuICAgIGNvbnN0IHByb2Nlc3NlZERhdGFBbWF0ZXVyQ291cGxlczogYW55W10gPSBbXTtcbiAgICB0cnkge1xuICAgICAgY29uc3QgemlwID0gbmV3IFBpelppcChhcnJheUJ1ZmZlcik7XG5cbiAgICAgIC8vIEV4dHJhY3QgdGV4dCB3aXRoIHByZXNlcnZlZCBsaW5lIGJyZWFrcyBieSBwYXJzaW5nIHRoZSBkb2N1bWVudC54bWwgZGlyZWN0bHlcbiAgICAgIGNvbnN0IGRvY1htbCA9IHppcC5maWxlc1snd29yZC9kb2N1bWVudC54bWwnXTtcbiAgICAgIGlmICghZG9jWG1sKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBET0NYIGZpbGU6IG1pc3NpbmcgZG9jdW1lbnQueG1sJyk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHhtbENvbnRlbnQgPSBkb2NYbWwuYXNUZXh0KCk7XG5cbiAgICAgIC8vIFBhcnNlIHBhcmFncmFwaHMgYW5kIHByZXNlcnZlIGxpbmUgYnJlYWtzXG4gICAgICBjb25zdCBwYXJhZ3JhcGhNYXRjaGVzID1cbiAgICAgICAgeG1sQ29udGVudC5tYXRjaCgvPHc6cFtePl0qPiguKj8pPFxcL3c6cD4vZykgfHwgW107XG4gICAgICBsZXQgcGFyYWdyYXBocyA9IFtdO1xuXG4gICAgICBmb3IgKGNvbnN0IHBhcmFncmFwaE1hdGNoIG9mIHBhcmFncmFwaE1hdGNoZXMpIHtcbiAgICAgICAgY29uc3QgdGV4dE1hdGNoZXMgPVxuICAgICAgICAgIHBhcmFncmFwaE1hdGNoLm1hdGNoKC88dzp0W14+XSo+KC4qPyk8XFwvdzp0Pi9nKSB8fCBbXTtcbiAgICAgICAgbGV0IHBhcmFncmFwaFRleHQgPSAnJztcblxuICAgICAgICBmb3IgKGNvbnN0IHRleHRNYXRjaCBvZiB0ZXh0TWF0Y2hlcykge1xuICAgICAgICAgIGNvbnN0IHRleHRDb250ZW50ID0gdGV4dE1hdGNoLnJlcGxhY2UoLzxcXC8/dzp0W14+XSo+L2csICcnKTtcbiAgICAgICAgICBwYXJhZ3JhcGhUZXh0ICs9IHRleHRDb250ZW50O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHBhcmFncmFwaFRleHQudHJpbSgpKSB7XG4gICAgICAgICAgcGFyYWdyYXBocy5wdXNoKHBhcmFncmFwaFRleHQudHJpbSgpKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0ZXh0ID0gcGFyYWdyYXBocy5qb2luKCdcXG4nKTtcbiAgICAgIC8vY29uc29sZS5sb2coJ0V4dHJhY3RlZCB0ZXh0IGZyb20gZG9jeCB3aXRoIGxpbmUgYnJlYWtzOicsIHRleHQpOyAvLyBMb2cgdGhlIGZ1bGwgZXh0cmFjdGVkIHRleHQgZm9yIGRlYnVnZ2luZ1xuICAgIH0gY2F0Y2ggKHBhcnNpbmdFcnJvcjogYW55KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkdXJpbmcgZG9jdW1lbnQgcGFyc2luZzonLCBwYXJzaW5nRXJyb3IpO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7XG4gICAgICAgICAgZXJyb3I6IGBEb2N1bWVudCBwYXJzaW5nIGZhaWxlZDogJHtcbiAgICAgICAgICAgIHBhcnNpbmdFcnJvci5tZXNzYWdlIHx8ICdVbmtub3duIGVycm9yJ1xuICAgICAgICAgIH1gLFxuICAgICAgICB9LFxuICAgICAgICB7IHN0YXR1czogNTAwIH1cbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKFxuICAgICAgJ0V4dHJhY3RlZCB0ZXh0IGZyb20gZG9jeCB3aXRoIGxpbmUgYnJlYWtzOicsXG4gICAgICB0ZXh0LnNwbGl0KCdcXG4nKS5sZW5ndGhcbiAgICApO1xuICAgIGlmICghdGV4dCB8fCB0ZXh0LnRyaW0oKSA9PT0gJycpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAge1xuICAgICAgICAgIGVycm9yOlxuICAgICAgICAgICAgJ0NvdWxkIG5vdCBleHRyYWN0IHRleHQgZnJvbSB0aGUgZG9jdW1lbnQuIEl0IG1pZ2h0IGJlIGVtcHR5IG9yIGNvcnJ1cHRlZC4nLFxuICAgICAgICB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gU3BsaXQgdGV4dCBpbnRvIGxpbmVzIGZvciBlYXNpZXIgcHJvY2Vzc2luZ1xuICAgIGNvbnN0IGxpbmVzID0gdGV4dFxuICAgICAgLnNwbGl0KCdcXG4nKVxuICAgICAgLm1hcCgobGluZSkgPT4gbGluZS50cmltKCkpXG4gICAgICAuZmlsdGVyKChsaW5lKSA9PiBsaW5lLmxlbmd0aCA+IDApO1xuXG4gICAgLy8gY29uc29sZS5sb2coJ0xpbmVzIGV4dHJhY3RlZDonLCBsaW5lcyk7XG4gICAgbGV0IHN1bU9mUG9pbnRzID0gMDtcbiAgICAvLyBQcm9jZXNzIGxpbmVzIHRvIGV4dHJhY3QgY29tcGV0aXRpb24gZGF0YVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tpXTtcbiAgICAgIGxldCBjdXJyZW50c3R1ZGVudDtcblxuICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBsaW5lIGNvbnRhaW5zIHN0dWRlbnQvdGVhY2hlciBpbmZvIGluIGZvcm1hdDogXCJOYW1lL05hbWUgKCNudW1iZXIpIFtMb2NhdGlvbl1cIiBvciBcIk5hbWUgKCNudW1iZXIpL05hbWUgW0xvY2F0aW9uXVwiXG4gICAgICBjb25zdCBzdHVkZW50VGVhY2hlck1hdGNoID0gbGluZS5tYXRjaChcbiAgICAgICAgL14oLis/KVxcLyguKz8pXFxzKlxcKCNcXGQrXFwpXFxzKlxcWy4rP1xcXSR8XiguKz8pXFxzKlxcKCNcXGQrXFwpXFwvKC4rPylcXHMqXFxbLis/XFxdJC9cbiAgICAgICk7XG5cbiAgICAgIGlmIChzdHVkZW50VGVhY2hlck1hdGNoKSB7XG4gICAgICAgIC8vIEhhbmRsZSBib3RoIGZvcm1hdHM6IE5hbWUvTmFtZSAoI251bWJlcikgW0xvY2F0aW9uXSBhbmQgTmFtZSAoI251bWJlcikvTmFtZSBbTG9jYXRpb25dXG4gICAgICAgIGxldCBzdHVkZW50LCB0ZWFjaGVyO1xuXG4gICAgICAgIGlmIChzdHVkZW50VGVhY2hlck1hdGNoWzFdICYmIHN0dWRlbnRUZWFjaGVyTWF0Y2hbMl0pIHtcbiAgICAgICAgICAvLyBGb3JtYXQ6IE5hbWUvTmFtZSAoI251bWJlcikgW0xvY2F0aW9uXVxuICAgICAgICAgIHN0dWRlbnQgPSBzdHVkZW50VGVhY2hlck1hdGNoWzFdLnRyaW0oKTtcbiAgICAgICAgICB0ZWFjaGVyID0gc3R1ZGVudFRlYWNoZXJNYXRjaFsyXS50cmltKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoc3R1ZGVudFRlYWNoZXJNYXRjaFszXSAmJiBzdHVkZW50VGVhY2hlck1hdGNoWzRdKSB7XG4gICAgICAgICAgLy8gRm9ybWF0OiBOYW1lICgjbnVtYmVyKS9OYW1lIFtMb2NhdGlvbl1cbiAgICAgICAgICBzdHVkZW50ID0gc3R1ZGVudFRlYWNoZXJNYXRjaFszXS50cmltKCk7XG4gICAgICAgICAgdGVhY2hlciA9IHN0dWRlbnRUZWFjaGVyTWF0Y2hbNF0udHJpbSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTG9vayBhaGVhZCBmb3IgYWxsIHBsYWNlL3Byb2ZpY2llbmN5IGFuZCBoZWF0L2V2ZW50IGluZm9ybWF0aW9uIGZvciB0aGlzIHN0dWRlbnQvdGVhY2hlciBwYWlyXG4gICAgICAgIGxldCBqID0gaSArIDE7XG5cbiAgICAgICAgLy8gQ29udGludWUgcHJvY2Vzc2luZyBlbnRyaWVzIHVudGlsIHdlIGhpdCBhbm90aGVyIHN0dWRlbnQvdGVhY2hlciBsaW5lIG9yIGVuZCBvZiBmaWxlXG4gICAgICAgIHdoaWxlIChqIDwgbGluZXMubGVuZ3RoKSB7XG4gICAgICAgICAgLy8gQ2hlY2sgaWYgd2UndmUgaGl0IGFub3RoZXIgc3R1ZGVudC90ZWFjaGVyIGxpbmVcbiAgICAgICAgICBjb25zdCBuZXh0U3R1ZGVudFRlYWNoZXJNYXRjaCA9IGxpbmVzW2pdLm1hdGNoKFxuICAgICAgICAgICAgL14oLis/KVxcLyguKz8pXFxzKlxcKCNcXGQrXFwpXFxzKlxcWy4rP1xcXSR8XiguKz8pXFxzKlxcKCNcXGQrXFwpXFwvKC4rPylcXHMqXFxbLis/XFxdJC9cbiAgICAgICAgICApO1xuICAgICAgICAgIGlmIChuZXh0U3R1ZGVudFRlYWNoZXJNYXRjaCkge1xuICAgICAgICAgICAgLy8gRm91bmQgYW5vdGhlciBzdHVkZW50L3RlYWNoZXIgcGFpciwgc3RvcCBwcm9jZXNzaW5nIGN1cnJlbnQgcGFpclxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgbGV0IHBsYWNlID0gJyc7XG4gICAgICAgICAgbGV0IHByb2ZpY2llbmN5ID0gJyc7XG4gICAgICAgICAgbGV0IGhlYXROdW1iZXIgPSAnJztcbiAgICAgICAgICBsZXQgZXZlbnREZXNjcmlwdGlvbiA9ICcnO1xuXG4gICAgICAgICAgLy8gRmluZCBwbGFjZS9wcm9maWNpZW5jeSBsaW5lIChmb3JtYXQ6IFwiMSBbOTMuMF1cIiBvciBqdXN0IFwiMVwiKVxuICAgICAgICAgIGNvbnN0IHBsYWNlTGluZSA9IGxpbmVzW2pdO1xuICAgICAgICAgIGNvbnN0IHBsYWNlTWF0Y2ggPSBwbGFjZUxpbmUubWF0Y2goL14oXFxkKykoPzpcXHMqXFxbKFxcZCtcXC4/XFxkKilcXF0pPyQvKTtcblxuICAgICAgICAgIGlmIChwbGFjZU1hdGNoKSB7XG4gICAgICAgICAgICBwbGFjZSA9IHBsYWNlTWF0Y2hbMV07XG4gICAgICAgICAgICBwcm9maWNpZW5jeSA9IHBsYWNlTWF0Y2hbMl0gfHwgJyc7XG4gICAgICAgICAgICBqKys7XG5cbiAgICAgICAgICAgIC8vIEZpbmQgaGVhdCBsaW5lIChmb3JtYXQ6IFwiSGVhdCA2MTJcIilcbiAgICAgICAgICAgIHdoaWxlIChqIDwgbGluZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIGNvbnN0IGhlYXRMaW5lID0gbGluZXNbal07XG4gICAgICAgICAgICAgIGNvbnN0IGhlYXRNYXRjaCA9IGhlYXRMaW5lLm1hdGNoKC9eKEhlYXR8U29sbylcXHMrKFxcZCspJC8pO1xuXG4gICAgICAgICAgICAgIGlmIChoZWF0TWF0Y2gpIHtcbiAgICAgICAgICAgICAgICBoZWF0TnVtYmVyID0gaGVhdE1hdGNoWzFdICsgJyAnICsgaGVhdE1hdGNoWzJdO1xuICAgICAgICAgICAgICAgIGorKztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBqKys7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEZpbmQgZXZlbnQgZGVzY3JpcHRpb24gbGluZSAobmV4dCBsaW5lIGFmdGVyIGhlYXQpXG4gICAgICAgICAgICBpZiAoaiA8IGxpbmVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGlzIGlzIGFub3RoZXIgc3R1ZGVudC90ZWFjaGVyIGxpbmVcbiAgICAgICAgICAgICAgY29uc3QgY2hlY2tTdHVkZW50VGVhY2hlciA9IGxpbmVzW2pdLm1hdGNoKFxuICAgICAgICAgICAgICAgIC9eKC4rPylcXC8oLis/KVxccypcXCgjXFxkK1xcKVxccypcXFsuKz9cXF0kfF4oLis/KVxccypcXCgjXFxkK1xcKVxcLyguKz8pXFxzKlxcWy4rP1xcXSQvXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIGlmICghY2hlY2tTdHVkZW50VGVhY2hlcikge1xuICAgICAgICAgICAgICAgIGV2ZW50RGVzY3JpcHRpb24gPSBsaW5lc1tqXTtcbiAgICAgICAgICAgICAgICBqKys7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gUHJvY2VzcyB0aGlzIGVudHJ5IGlmIHdlIGhhdmUgYWxsIHJlcXVpcmVkIGluZm9ybWF0aW9uXG4gICAgICAgICAgICBpZiAoc3R1ZGVudCAmJiB0ZWFjaGVyICYmIHBsYWNlICYmIGhlYXROdW1iZXIgJiYgZXZlbnREZXNjcmlwdGlvbikge1xuICAgICAgICAgICAgICAvLyBDaGVjayBmb3IgXCJBQy1cIiBvciBcIlBybyBoZWF0XCIgaW5kaWNhdG9yc1xuICAgICAgICAgICAgICBpZiAoZXZlbnREZXNjcmlwdGlvbi5pbmNsdWRlcygnQUMtJykpIHtcbiAgICAgICAgICAgICAgICAvLyBQcm9jZXNzIEFDLSBlbnRyaWVzIHNlcGFyYXRlbHlcbiAgICAgICAgICAgICAgICBjb25zdCBmdWxsRXZlbnQgPSBgICR7aGVhdE51bWJlcn0gJHtldmVudERlc2NyaXB0aW9uLnRyaW0oKX1gO1xuICAgICAgICAgICAgICAgIGxldCBwb2ludHMgPSAwO1xuXG4gICAgICAgICAgICAgICAgLy8gQmFzZSBQb2ludHMgZm9yIEV2ZW50IFR5cGVzXG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgZnVsbEV2ZW50LmluY2x1ZGVzKCdTY2hvbCcpIHx8XG4gICAgICAgICAgICAgICAgICBmdWxsRXZlbnQuaW5jbHVkZXMoJ0NoYW1wJylcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgIC8vIEZvciBTY2hvbGFyc2hpcCBvciBDaGFtcGlvbnNoaXAgZXZlbnRzLCBjb3VudCBzbGFzaGVzIGJldHdlZW4gcGFyZW50aGVzZXNcbiAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudGhlc2VzTWF0Y2ggPSBmdWxsRXZlbnQubWF0Y2goL1xcKChbXildKylcXCkvKTtcbiAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnRoZXNlc01hdGNoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRJblBhcmVudGhlc2VzID0gcGFyZW50aGVzZXNNYXRjaFsxXTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2xhc2hDb3VudCA9IChjb250ZW50SW5QYXJlbnRoZXNlcy5tYXRjaCgvXFwvL2cpIHx8IFtdKVxuICAgICAgICAgICAgICAgICAgICAgIC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHBvaW50cyA9IHNsYXNoQ291bnQgKyAyO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRzID0gMjtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcG9pbnRzID0gMTE7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gQWRkaXRpb25hbCBQb2ludHMgZm9yIFBsYWNlbWVudCBvciBQcm9maWNpZW5jeVxuICAgICAgICAgICAgICAgIGlmIChwcm9maWNpZW5jeSkge1xuICAgICAgICAgICAgICAgICAgY29uc3QgcHJvZlNjb3JlID0gcGFyc2VGbG9hdChwcm9maWNpZW5jeSk7XG4gICAgICAgICAgICAgICAgICBpZiAocHJvZlNjb3JlID49IDk2LjUpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRzICs9IDM7XG4gICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHByb2ZTY29yZSA+PSA5My41KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvaW50cyArPSAyO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwcm9mU2NvcmUgPj0gODkuNSkge1xuICAgICAgICAgICAgICAgICAgICBwb2ludHMgKz0gMTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgY29uc3QgcGxhY2VOdW0gPSBwYXJzZUludChwbGFjZSk7XG4gICAgICAgICAgICAgICAgICBpZiAocGxhY2VOdW0gPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRzICs9IDM7XG4gICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBsYWNlTnVtID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgIHBvaW50cyArPSAyO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwbGFjZU51bSA9PT0gMykge1xuICAgICAgICAgICAgICAgICAgICBwb2ludHMgKz0gMTtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNOYU4ocGxhY2VOdW0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHBvaW50cyAtPSAxO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHByb2Nlc3NlZERhdGFBbWF0ZXVyQ291cGxlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgIFN0dWRlbnQ6IHN0dWRlbnQudHJpbSgpLFxuICAgICAgICAgICAgICAgICAgVGVhY2hlcjogdGVhY2hlci50cmltKCksXG4gICAgICAgICAgICAgICAgICBFdmVudDogZnVsbEV2ZW50LnRyaW0oKSxcbiAgICAgICAgICAgICAgICAgIFBsYWNlOiBwbGFjZS50cmltKCksXG4gICAgICAgICAgICAgICAgICBQcm9maWNpZW5jeTogcHJvZmljaWVuY3kgPyBwcm9maWNpZW5jeS50cmltKCkgOiAnJyxcbiAgICAgICAgICAgICAgICAgIFBvaW50czogcG9pbnRzLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50RGVzY3JpcHRpb24udG9Mb3dlckNhc2UoKS5pbmNsdWRlcygncHJvIGhlYXQnKSkge1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdTa2lwcGluZyBmaWx0ZXJlZCBlbnRyeTonLCBldmVudERlc2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGNvbnN0IGZ1bGxFdmVudCA9IGAgJHtoZWF0TnVtYmVyfSAke2V2ZW50RGVzY3JpcHRpb24udHJpbSgpfWA7XG4gICAgICAgICAgICAgIGxldCBwb2ludHMgPSAwO1xuXG4gICAgICAgICAgICAgIC8vIEJhc2UgUG9pbnRzIGZvciBFdmVudCBUeXBlc1xuICAgICAgICAgICAgICBpZiAoZnVsbEV2ZW50LmluY2x1ZGVzKCdTY2hvbCcpIHx8IGZ1bGxFdmVudC5pbmNsdWRlcygnQ2hhbXAnKSkge1xuICAgICAgICAgICAgICAgIC8vIEZvciBTY2hvbGFyc2hpcCBvciBDaGFtcGlvbnNoaXAgZXZlbnRzLCBjb3VudCBzbGFzaGVzIGJldHdlZW4gcGFyZW50aGVzZXNcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnRoZXNlc01hdGNoID0gZnVsbEV2ZW50Lm1hdGNoKC9cXCgoW14pXSspXFwpLyk7XG4gICAgICAgICAgICAgICAgaWYgKHBhcmVudGhlc2VzTWF0Y2gpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRJblBhcmVudGhlc2VzID0gcGFyZW50aGVzZXNNYXRjaFsxXTtcblxuICAgICAgICAgICAgICAgICAgY29uc3Qgc2xhc2hDb3VudCA9IChjb250ZW50SW5QYXJlbnRoZXNlcy5tYXRjaCgvXFwvL2cpIHx8IFtdKVxuICAgICAgICAgICAgICAgICAgICAubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgcG9pbnRzID0gc2xhc2hDb3VudCArIDI7IC8vYmVjYXVzZSBvZiBzdWJzdHJ1Y3Rpb24gLTEgaW4gdGhlIGVuZCsxIGFuZCArMSBiZWNhdXNlIG9mIHNsYXNoZXMgbGVzcyB0aGVuIGRhbmNlc1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAvLyBEZWZhdWx0IGlmIG5vIHBhcmVudGhlc2VzIGZvdW5kXG4gICAgICAgICAgICAgICAgICBwb2ludHMgPSAyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBBbGwgaW5kaXZpZHVhbCBlbnRyaWVzLCBTb2xvLCBOb3ZlbHR5LCBTaG93Y2FzZVxuICAgICAgICAgICAgICAgIHBvaW50cyA9IDExO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgLy8gQWRkaXRpb25hbCBQb2ludHMgZm9yIFBsYWNlbWVudCBvciBQcm9maWNpZW5jeVxuICAgICAgICAgICAgICBpZiAocHJvZmljaWVuY3kpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9mU2NvcmUgPSBwYXJzZUZsb2F0KHByb2ZpY2llbmN5KTtcbiAgICAgICAgICAgICAgICBpZiAocHJvZlNjb3JlID49IDk2LjUpIHtcbiAgICAgICAgICAgICAgICAgIHBvaW50cyArPSAzO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocHJvZlNjb3JlID49IDkzLjUpIHtcbiAgICAgICAgICAgICAgICAgIHBvaW50cyArPSAyO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocHJvZlNjb3JlID49IDg5LjUpIHtcbiAgICAgICAgICAgICAgICAgIHBvaW50cyArPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwbGFjZU51bSA9IHBhcnNlSW50KHBsYWNlKTtcbiAgICAgICAgICAgICAgICBpZiAocGxhY2VOdW0gPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgIHBvaW50cyArPSAzO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGxhY2VOdW0gPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgIHBvaW50cyArPSAyO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGxhY2VOdW0gPT09IDMpIHtcbiAgICAgICAgICAgICAgICAgIHBvaW50cyArPSAxO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNOYU4ocGxhY2VOdW0pKSB7XG4gICAgICAgICAgICAgICAgICAvLyBJZiBubyBudW1lcmljYWwgcGxhY2VcbiAgICAgICAgICAgICAgICAgIHBvaW50cyAtPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBpZiAoY3VycmVudHN0dWRlbnQgIT09IHN0dWRlbnQudHJpbSgpKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudHN0dWRlbnQgPSBzdHVkZW50LnRyaW0oKTtcbiAgICAgICAgICAgICAgICBpZiAocHJvY2Vzc2VkRGF0YS5sZW5ndGggPiAxKVxuICAgICAgICAgICAgICAgICAgcHJvY2Vzc2VkRGF0YS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgU3R1ZGVudDogJ1RvdGFsIDonLFxuICAgICAgICAgICAgICAgICAgICBUZWFjaGVyOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgRXZlbnQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICBQbGFjZTogJycsXG4gICAgICAgICAgICAgICAgICAgIFByb2ZpY2llbmN5OiAnJyxcbiAgICAgICAgICAgICAgICAgICAgUG9pbnRzOiBzdW1PZlBvaW50cyxcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHN1bU9mUG9pbnRzID0gcG9pbnRzO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHN1bU9mUG9pbnRzICs9IHBvaW50cztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBwcm9jZXNzZWREYXRhLnB1c2goe1xuICAgICAgICAgICAgICAgIFN0dWRlbnQ6IHN0dWRlbnQudHJpbSgpLFxuICAgICAgICAgICAgICAgIFRlYWNoZXI6IHRlYWNoZXIudHJpbSgpLFxuICAgICAgICAgICAgICAgIEV2ZW50OiBmdWxsRXZlbnQudHJpbSgpLFxuICAgICAgICAgICAgICAgIFBsYWNlOiBwbGFjZS50cmltKCksXG4gICAgICAgICAgICAgICAgUHJvZmljaWVuY3k6IHByb2ZpY2llbmN5ID8gcHJvZmljaWVuY3kudHJpbSgpIDogJycsXG4gICAgICAgICAgICAgICAgUG9pbnRzOiBwb2ludHMsXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NraXBwaW5nIGluY29tcGxldGUgZW50cnk6Jywge1xuICAgICAgICAgICAgICAgIHN0dWRlbnQsXG4gICAgICAgICAgICAgICAgdGVhY2hlcixcbiAgICAgICAgICAgICAgICBwbGFjZSxcbiAgICAgICAgICAgICAgICBoZWF0TnVtYmVyLFxuICAgICAgICAgICAgICAgIGV2ZW50RGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBJZiB0aGlzIGxpbmUgZG9lc24ndCBtYXRjaCBhIHBsYWNlIHBhdHRlcm4sIG1vdmUgdG8gbmV4dCBsaW5lXG4gICAgICAgICAgICBqKys7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gVXBkYXRlIGkgdG8gai0xIHNvIHRoZSBtYWluIGxvb3AgY29udGludWVzIGZyb20gd2hlcmUgd2UgbGVmdCBvZmZcbiAgICAgICAgaSA9IGogLSAxO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChwcm9jZXNzZWREYXRhLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiAnTm8gdmFsaWQgZW50cmllcyBmb3VuZCBpbiB0aGUgZG9jdW1lbnQgYWZ0ZXIgcHJvY2Vzc2luZy4nIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBDYWxjdWxhdGUgdG90YWxzIGZvciBlYWNoIHVuaXF1ZSBzdHVkZW50IGFuZCB0ZWFjaGVyXG4gICAgY29uc3Qgc3R1ZGVudFRvdGFscyA9IG5ldyBNYXA8c3RyaW5nLCBudW1iZXI+KCk7XG4gICAgY29uc3QgdGVhY2hlclRvdGFscyA9IG5ldyBNYXA8c3RyaW5nLCBudW1iZXI+KCk7XG5cbiAgICAvLyBDYWxjdWxhdGUgdG90YWxzIGZyb20gcHJvY2Vzc2VkIGRhdGEgKGV4Y2x1ZGluZyBhbnkgZXhpc3RpbmcgXCJUb3RhbCA6XCIgZW50cmllcylcbiAgICBwcm9jZXNzZWREYXRhLmZvckVhY2goKGVudHJ5KSA9PiB7XG4gICAgICBpZiAoZW50cnkuU3R1ZGVudCAhPT0gJ1RvdGFsIDonKSB7XG4gICAgICAgIGNvbnN0IHN0dWRlbnQgPSBlbnRyeS5TdHVkZW50O1xuICAgICAgICBjb25zdCB0ZWFjaGVyID0gZW50cnkuVGVhY2hlcjtcbiAgICAgICAgY29uc3QgcG9pbnRzID0gZW50cnkuUG9pbnRzO1xuXG4gICAgICAgIC8vIEFkZCB0byBzdHVkZW50IHRvdGFsc1xuICAgICAgICBzdHVkZW50VG90YWxzLnNldChzdHVkZW50LCAoc3R1ZGVudFRvdGFscy5nZXQoc3R1ZGVudCkgfHwgMCkgKyBwb2ludHMpO1xuXG4gICAgICAgIC8vIEFkZCB0byB0ZWFjaGVyIHRvdGFsc1xuICAgICAgICB0ZWFjaGVyVG90YWxzLnNldCh0ZWFjaGVyLCAodGVhY2hlclRvdGFscy5nZXQodGVhY2hlcikgfHwgMCkgKyBwb2ludHMpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gQ3JlYXRlIGZpbmFsIGRhdGEgYXJyYXkgd2l0aCBwcm9wZXIgb3JkZXJcbiAgICBjb25zdCBmaW5hbFByb2Nlc3NlZERhdGE6IGFueVtdID0gW107XG5cbiAgICAvLyAxLiBBZGQgc3R1ZGVudCB0b3RhbHMgZmlyc3RcbiAgICBmaW5hbFByb2Nlc3NlZERhdGEucHVzaCh7XG4gICAgICBTdHVkZW50OiAnU1RVREVOVCBUT1RBTFM6JyxcbiAgICAgIFRlYWNoZXI6ICcnLFxuICAgICAgRXZlbnQ6ICcnLFxuICAgICAgUGxhY2U6ICcnLFxuICAgICAgUHJvZmljaWVuY3k6ICcnLFxuICAgICAgUG9pbnRzOiAnJyxcbiAgICB9KTtcblxuICAgIHN0dWRlbnRUb3RhbHMuZm9yRWFjaCgodG90YWwsIHN0dWRlbnQpID0+IHtcbiAgICAgIGZpbmFsUHJvY2Vzc2VkRGF0YS5wdXNoKHtcbiAgICAgICAgU3R1ZGVudDogc3R1ZGVudCxcbiAgICAgICAgVGVhY2hlcjogJycsXG4gICAgICAgIEV2ZW50OiAnJyxcbiAgICAgICAgUGxhY2U6ICcnLFxuICAgICAgICBQcm9maWNpZW5jeTogJycsXG4gICAgICAgIFBvaW50czogdG90YWwsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIDIuIEFkZCB0ZWFjaGVyIHRvdGFsc1xuICAgIGZpbmFsUHJvY2Vzc2VkRGF0YS5wdXNoKHtcbiAgICAgIFN0dWRlbnQ6ICcnLFxuICAgICAgVGVhY2hlcjogJycsXG4gICAgICBFdmVudDogJycsXG4gICAgICBQbGFjZTogJycsXG4gICAgICBQcm9maWNpZW5jeTogJycsXG4gICAgICBQb2ludHM6ICcnLFxuICAgIH0pO1xuXG4gICAgZmluYWxQcm9jZXNzZWREYXRhLnB1c2goe1xuICAgICAgU3R1ZGVudDogJ1RFQUNIRVIgVE9UQUxTOicsXG4gICAgICBUZWFjaGVyOiAnJyxcbiAgICAgIEV2ZW50OiAnJyxcbiAgICAgIFBsYWNlOiAnJyxcbiAgICAgIFByb2ZpY2llbmN5OiAnJyxcbiAgICAgIFBvaW50czogJycsXG4gICAgfSk7XG5cbiAgICB0ZWFjaGVyVG90YWxzLmZvckVhY2goKHRvdGFsLCB0ZWFjaGVyKSA9PiB7XG4gICAgICBmaW5hbFByb2Nlc3NlZERhdGEucHVzaCh7XG4gICAgICAgIFN0dWRlbnQ6ICcnLFxuICAgICAgICBUZWFjaGVyOiB0ZWFjaGVyLFxuICAgICAgICBFdmVudDogJycsXG4gICAgICAgIFBsYWNlOiAnJyxcbiAgICAgICAgUHJvZmljaWVuY3k6ICcnLFxuICAgICAgICBQb2ludHM6IHRvdGFsLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyAzLiBBZGQgQW1hdGV1ciBDb3VwbGVzIHRvdGFscyAoaWYgYW55KVxuICAgIGlmIChwcm9jZXNzZWREYXRhQW1hdGV1ckNvdXBsZXMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgYW1hdGV1ckNvdXBsZVRvdGFscyA9IG5ldyBNYXA8c3RyaW5nLCBudW1iZXI+KCk7XG5cbiAgICAgIHByb2Nlc3NlZERhdGFBbWF0ZXVyQ291cGxlcy5mb3JFYWNoKChlbnRyeSkgPT4ge1xuICAgICAgICBjb25zdCBjb3VwbGVLZXkgPSBgJHtlbnRyeS5TdHVkZW50fS8ke2VudHJ5LlRlYWNoZXJ9YDtcbiAgICAgICAgYW1hdGV1ckNvdXBsZVRvdGFscy5zZXQoXG4gICAgICAgICAgY291cGxlS2V5LFxuICAgICAgICAgIChhbWF0ZXVyQ291cGxlVG90YWxzLmdldChjb3VwbGVLZXkpIHx8IDApICsgZW50cnkuUG9pbnRzXG4gICAgICAgICk7XG4gICAgICB9KTtcblxuICAgICAgZmluYWxQcm9jZXNzZWREYXRhLnB1c2goe1xuICAgICAgICBTdHVkZW50OiAnJyxcbiAgICAgICAgVGVhY2hlcjogJycsXG4gICAgICAgIEV2ZW50OiAnJyxcbiAgICAgICAgUGxhY2U6ICcnLFxuICAgICAgICBQcm9maWNpZW5jeTogJycsXG4gICAgICAgIFBvaW50czogJycsXG4gICAgICB9KTtcblxuICAgICAgZmluYWxQcm9jZXNzZWREYXRhLnB1c2goe1xuICAgICAgICBTdHVkZW50OiAnQU1BVEVVUiBDT1VQTEVTIFRPVEFMUzonLFxuICAgICAgICBUZWFjaGVyOiAnJyxcbiAgICAgICAgRXZlbnQ6ICcnLFxuICAgICAgICBQbGFjZTogJycsXG4gICAgICAgIFByb2ZpY2llbmN5OiAnJyxcbiAgICAgICAgUG9pbnRzOiAnJyxcbiAgICAgIH0pO1xuXG4gICAgICBhbWF0ZXVyQ291cGxlVG90YWxzLmZvckVhY2goKHRvdGFsLCBjb3VwbGUpID0+IHtcbiAgICAgICAgY29uc3QgW3N0dWRlbnQsIHRlYWNoZXJdID0gY291cGxlLnNwbGl0KCcvJyk7XG4gICAgICAgIGZpbmFsUHJvY2Vzc2VkRGF0YS5wdXNoKHtcbiAgICAgICAgICBTdHVkZW50OiBzdHVkZW50LFxuICAgICAgICAgIFRlYWNoZXI6IHRlYWNoZXIsXG4gICAgICAgICAgRXZlbnQ6ICcnLFxuICAgICAgICAgIFBsYWNlOiAnJyxcbiAgICAgICAgICBQcm9maWNpZW5jeTogJycsXG4gICAgICAgICAgUG9pbnRzOiB0b3RhbCxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gNC4gQWRkIEFtYXRldXIgQ291cGxlcyBlbnRyaWVzXG4gICAgICBmaW5hbFByb2Nlc3NlZERhdGEucHVzaCh7XG4gICAgICAgIFN0dWRlbnQ6ICcnLFxuICAgICAgICBUZWFjaGVyOiAnJyxcbiAgICAgICAgRXZlbnQ6ICcnLFxuICAgICAgICBQbGFjZTogJycsXG4gICAgICAgIFByb2ZpY2llbmN5OiAnJyxcbiAgICAgICAgUG9pbnRzOiAnJyxcbiAgICAgIH0pO1xuXG4gICAgICBmaW5hbFByb2Nlc3NlZERhdGEucHVzaCh7XG4gICAgICAgIFN0dWRlbnQ6ICdBTUFURVVSIENPVVBMRVMgRU5UUklFUzonLFxuICAgICAgICBUZWFjaGVyOiAnJyxcbiAgICAgICAgRXZlbnQ6ICcnLFxuICAgICAgICBQbGFjZTogJycsXG4gICAgICAgIFByb2ZpY2llbmN5OiAnJyxcbiAgICAgICAgUG9pbnRzOiAnJyxcbiAgICAgIH0pO1xuXG4gICAgICBwcm9jZXNzZWREYXRhQW1hdGV1ckNvdXBsZXMuZm9yRWFjaCgoZW50cnkpID0+IHtcbiAgICAgICAgZmluYWxQcm9jZXNzZWREYXRhLnB1c2goZW50cnkpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gNS4gQWRkIG90aGVyIGVudHJpZXMgKG1haW4gY29tcGV0aXRpb24gZW50cmllcylcbiAgICBmaW5hbFByb2Nlc3NlZERhdGEucHVzaCh7XG4gICAgICBTdHVkZW50OiAnJyxcbiAgICAgIFRlYWNoZXI6ICcnLFxuICAgICAgRXZlbnQ6ICcnLFxuICAgICAgUGxhY2U6ICcnLFxuICAgICAgUHJvZmljaWVuY3k6ICcnLFxuICAgICAgUG9pbnRzOiAnJyxcbiAgICB9KTtcblxuICAgIGZpbmFsUHJvY2Vzc2VkRGF0YS5wdXNoKHtcbiAgICAgIFN0dWRlbnQ6ICdNQUlOIENPTVBFVElUSU9OIEVOVFJJRVM6JyxcbiAgICAgIFRlYWNoZXI6ICcnLFxuICAgICAgRXZlbnQ6ICcnLFxuICAgICAgUGxhY2U6ICcnLFxuICAgICAgUHJvZmljaWVuY3k6ICcnLFxuICAgICAgUG9pbnRzOiAnJyxcbiAgICB9KTtcblxuICAgIC8vIEFkZCBhbGwgbWFpbiBlbnRyaWVzIChleGNsdWRpbmcgXCJUb3RhbCA6XCIgZW50cmllcylcbiAgICBwcm9jZXNzZWREYXRhLmZvckVhY2goKGVudHJ5KSA9PiB7XG4gICAgICBpZiAoZW50cnkuU3R1ZGVudCAhPT0gJ1RvdGFsIDonKSB7XG4gICAgICAgIGZpbmFsUHJvY2Vzc2VkRGF0YS5wdXNoKGVudHJ5KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIEdlbmVyYXRlIENTVlxuICAgIGNvbnN0IGNzdkhlYWRlciA9ICdTdHVkZW50LFRlYWNoZXIsRXZlbnQsUGxhY2UsUHJvZmljaWVuY3ksUG9pbnRzXFxuJztcbiAgICBjb25zdCBjc3ZSb3dzID0gZmluYWxQcm9jZXNzZWREYXRhXG4gICAgICAubWFwKFxuICAgICAgICAocm93KSA9PlxuICAgICAgICAgIGBcIiR7cm93LlN0dWRlbnR9XCIsXCIke3Jvdy5UZWFjaGVyfVwiLFwiJHtyb3cuRXZlbnR9XCIsXCIke3Jvdy5QbGFjZX1cIixcIiR7cm93LlByb2ZpY2llbmN5fVwiLCR7cm93LlBvaW50c31gXG4gICAgICApXG4gICAgICAuam9pbignXFxuJyk7XG5cbiAgICBjb25zdCBjc3YgPSBjc3ZIZWFkZXIgKyBjc3ZSb3dzO1xuXG4gICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UoY3N2LCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdDb250ZW50LVR5cGUnOiAndGV4dC9jc3YnLFxuICAgICAgICAnQ29udGVudC1EaXNwb3NpdGlvbic6ICdhdHRhY2htZW50OyBmaWxlbmFtZT1cImNvbXBldGl0aW9uX3Jlc3VsdHMuY3N2XCInLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1VuaGFuZGxlZCBlcnJvciBpbiBBUEkgcm91dGU6JywgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfHwgJ0ludGVybmFsIFNlcnZlciBFcnJvcicgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJQaXpaaXAiLCJydW50aW1lIiwiUE9TVCIsInJlcSIsImNvbnNvbGUiLCJsb2ciLCJmb3JtRGF0YSIsImRvY3hGaWxlIiwiZ2V0IiwiZXJyb3IiLCJqc29uIiwic3RhdHVzIiwibmFtZSIsImFycmF5QnVmZmVyIiwidGV4dCIsInByb2Nlc3NlZERhdGEiLCJwcm9jZXNzZWREYXRhQW1hdGV1ckNvdXBsZXMiLCJ6aXAiLCJkb2NYbWwiLCJmaWxlcyIsIkVycm9yIiwieG1sQ29udGVudCIsImFzVGV4dCIsInBhcmFncmFwaE1hdGNoZXMiLCJtYXRjaCIsInBhcmFncmFwaHMiLCJwYXJhZ3JhcGhNYXRjaCIsInRleHRNYXRjaGVzIiwicGFyYWdyYXBoVGV4dCIsInRleHRNYXRjaCIsInRleHRDb250ZW50IiwicmVwbGFjZSIsInRyaW0iLCJwdXNoIiwiam9pbiIsInBhcnNpbmdFcnJvciIsIm1lc3NhZ2UiLCJzcGxpdCIsImxlbmd0aCIsImxpbmVzIiwibWFwIiwibGluZSIsImZpbHRlciIsInN1bU9mUG9pbnRzIiwiaSIsImN1cnJlbnRzdHVkZW50Iiwic3R1ZGVudFRlYWNoZXJNYXRjaCIsInN0dWRlbnQiLCJ0ZWFjaGVyIiwiaiIsIm5leHRTdHVkZW50VGVhY2hlck1hdGNoIiwicGxhY2UiLCJwcm9maWNpZW5jeSIsImhlYXROdW1iZXIiLCJldmVudERlc2NyaXB0aW9uIiwicGxhY2VMaW5lIiwicGxhY2VNYXRjaCIsImhlYXRMaW5lIiwiaGVhdE1hdGNoIiwiY2hlY2tTdHVkZW50VGVhY2hlciIsImluY2x1ZGVzIiwiZnVsbEV2ZW50IiwicG9pbnRzIiwicGFyZW50aGVzZXNNYXRjaCIsImNvbnRlbnRJblBhcmVudGhlc2VzIiwic2xhc2hDb3VudCIsInByb2ZTY29yZSIsInBhcnNlRmxvYXQiLCJwbGFjZU51bSIsInBhcnNlSW50IiwiaXNOYU4iLCJTdHVkZW50IiwiVGVhY2hlciIsIkV2ZW50IiwiUGxhY2UiLCJQcm9maWNpZW5jeSIsIlBvaW50cyIsInRvTG93ZXJDYXNlIiwic3R1ZGVudFRvdGFscyIsIk1hcCIsInRlYWNoZXJUb3RhbHMiLCJmb3JFYWNoIiwiZW50cnkiLCJzZXQiLCJmaW5hbFByb2Nlc3NlZERhdGEiLCJ0b3RhbCIsImFtYXRldXJDb3VwbGVUb3RhbHMiLCJjb3VwbGVLZXkiLCJjb3VwbGUiLCJjc3ZIZWFkZXIiLCJjc3ZSb3dzIiwicm93IiwiY3N2IiwiaGVhZGVycyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/process-doc/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/pizzip","vendor-chunks/pako"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fprocess-doc%2Froute&page=%2Fapi%2Fprocess-doc%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fprocess-doc%2Froute.ts&appDir=C%3A%5CUsers%5Csbolo%5CWebProjects%5Cmorristown-results%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Csbolo%5CWebProjects%5Cmorristown-results&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();